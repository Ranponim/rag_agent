# ğŸ“˜ 01. Basic Agent - LangGraph ê¸°ë³¸ ê°œë…

LangGraphì˜ í•µì‹¬ ê°œë…ì„ í•™ìŠµí•˜ëŠ” ê¸°ë³¸ Agent ì˜ˆì œì…ë‹ˆë‹¤.

---

## ğŸ“‹ ëª©ì°¨

- [ê°œìš”](#ê°œìš”)
- [í•µì‹¬ ê°œë…](#í•µì‹¬-ê°œë…)
- [ì½”ë“œ ë¶„ì„](#ì½”ë“œ-ë¶„ì„)
- [ì‹¤í–‰ ê²°ê³¼](#ì‹¤í–‰-ê²°ê³¼)
- [ì—°ìŠµ ë¬¸ì œ](#ì—°ìŠµ-ë¬¸ì œ)

---

## ê°œìš”

### í•™ìŠµ ëª©í‘œ

1. **StateGraph** - ê·¸ë˜í”„ ë¹Œë”ì˜ ì—­í•  ì´í•´
2. **Nodeì™€ Edge** - ì‘ì—… ë‹¨ìœ„ì™€ ì—°ê²°ì˜ ê°œë…
3. **Tool ë°”ì¸ë”©** - LLMì— ë„êµ¬ ì—°ê²°í•˜ëŠ” ë°©ë²•
4. **ì¡°ê±´ë¶€ ë¶„ê¸°** - ìƒí™©ì— ë”°ë¥¸ ì‹¤í–‰ íë¦„ ì œì–´

### ê·¸ë˜í”„ êµ¬ì¡°

```mermaid
graph TD
    START((START)) --> agent[Agent ë…¸ë“œ]
    agent -->|ë„êµ¬ í˜¸ì¶œ í•„ìš”| tools[Tools ë…¸ë“œ]
    agent -->|ìµœì¢… ì‘ë‹µ| END((END))
    tools --> agent
```

---

## í•µì‹¬ ê°œë…

### 1. State (ìƒíƒœ)

ê·¸ë˜í”„ë¥¼ í†µí•´ ì „ë‹¬ë˜ëŠ” ê³µìœ  ë°ì´í„°ì…ë‹ˆë‹¤.

```python
from langgraph.graph import MessagesState

# MessagesStateëŠ” messages í•„ë“œë¥¼ ê°€ì§„ ê¸°ë³¸ ìƒíƒœ
# messages: list[BaseMessage] - ëŒ€í™” íˆìŠ¤í† ë¦¬
```

**ìƒíƒœì˜ ì—­í• :**
- ë…¸ë“œ ê°„ ë°ì´í„° ê³µìœ 
- ëŒ€í™” íˆìŠ¤í† ë¦¬ ìœ ì§€
- ì¤‘ê°„ ê²°ê³¼ ì €ì¥

---

### 2. Node (ë…¸ë“œ)

ê·¸ë˜í”„ì—ì„œ ì‹¤ì œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë‹¨ìœ„ì…ë‹ˆë‹¤.

```python
def agent_node(state: MessagesState):
    """
    ë…¸ë“œ í•¨ìˆ˜ëŠ” ìƒíƒœë¥¼ ë°›ì•„ ì—…ë°ì´íŠ¸ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
    
    Args:
        state: í˜„ì¬ ê·¸ë˜í”„ ìƒíƒœ
    
    Returns:
        dict: ì—…ë°ì´íŠ¸í•  ìƒíƒœ (ê¸°ì¡´ ìƒíƒœì™€ ë³‘í•©ë¨)
    """
    llm = get_llm()
    response = llm.invoke(state["messages"])
    return {"messages": [response]}
```

---

### 3. Edge (ì—£ì§€)

ë…¸ë“œ ê°„ì˜ ì—°ê²°ì„ ì •ì˜í•©ë‹ˆë‹¤.

**ë‹¨ìˆœ ì—£ì§€:** ë¬´ì¡°ê±´ ë‹¤ìŒ ë…¸ë“œë¡œ ì´ë™
```python
graph.add_edge(START, "agent")
graph.add_edge("tools", "agent")
```

**ì¡°ê±´ë¶€ ì—£ì§€:** ì¡°ê±´ì— ë”°ë¼ ë¶„ê¸°
```python
graph.add_conditional_edges(
    "agent",           # ì‹œì‘ ë…¸ë“œ
    should_continue,   # ë¼ìš°í„° í•¨ìˆ˜
)
```

---

### 4. Tool (ë„êµ¬)

Agentê°€ ì™¸ë¶€ ì‘ì—…ì„ ìˆ˜í–‰í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.

```python
from langchain_core.tools import tool

@tool
def get_weather(city: str) -> str:
    """íŠ¹ì • ë„ì‹œì˜ ë‚ ì”¨ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤."""
    return f"{city}: ë§‘ìŒ, 15ë„"

# LLMì— ë„êµ¬ ë°”ì¸ë”©
llm_with_tools = llm.bind_tools([get_weather])
```

---

## ì½”ë“œ ë¶„ì„

### ì „ì²´ íë¦„

```
1. ì‚¬ìš©ì ì§ˆë¬¸ â†’ HumanMessage ìƒì„±
2. Agent ë…¸ë“œ â†’ LLM í˜¸ì¶œ (ë„êµ¬ ë°”ì¸ë”©ë¨)
3. LLM ì‘ë‹µ ë¶„ì„:
   - tool_calls ìˆìŒ â†’ Tools ë…¸ë“œë¡œ ì´ë™
   - tool_calls ì—†ìŒ â†’ ENDë¡œ ì¢…ë£Œ
4. Tools ë…¸ë“œ â†’ ë„êµ¬ ì‹¤í–‰, ê²°ê³¼ë¥¼ ìƒíƒœì— ì¶”ê°€
5. ë‹¤ì‹œ Agent ë…¸ë“œ â†’ ë„êµ¬ ê²°ê³¼ ë°”íƒ•ìœ¼ë¡œ ìµœì¢… ì‘ë‹µ ìƒì„±
```

### í•µì‹¬ ì½”ë“œ ì„¤ëª…

#### ë„êµ¬ ì •ì˜
```python
@tool
def calculate(expression: str) -> str:
    """ìˆ˜í•™ í‘œí˜„ì‹ì„ ê³„ì‚°í•©ë‹ˆë‹¤."""
    result = eval(expression)  # ì˜ˆì œìš©, ì‹¤ì œë¡œëŠ” ì•ˆì „í•œ ë°©ë²• ì‚¬ìš©
    return f"ê²°ê³¼: {result}"
```

#### ë¼ìš°í„° í•¨ìˆ˜
```python
def should_continue(state) -> Literal["tools", END]:
    """ë„êµ¬ í˜¸ì¶œì´ í•„ìš”í•œì§€ íŒë‹¨"""
    last_message = state["messages"][-1]
    
    # AIMessageì˜ tool_calls í™•ì¸
    if last_message.tool_calls:
        return "tools"  # ë„êµ¬ ì‹¤í–‰
    return END          # ì¢…ë£Œ
```

#### ê·¸ë˜í”„ êµ¬ì„±
```python
graph = StateGraph(MessagesState)

# ë…¸ë“œ ì¶”ê°€
graph.add_node("agent", agent_node)
graph.add_node("tools", ToolNode(tools))

# ì—£ì§€ ì¶”ê°€
graph.add_edge(START, "agent")
graph.add_conditional_edges("agent", should_continue)
graph.add_edge("tools", "agent")

# ì»´íŒŒì¼
compiled = graph.compile()
```

---

## ì‹¤í–‰ ê²°ê³¼

### í…ŒìŠ¤íŠ¸ 1: ë„êµ¬ ì‚¬ìš© (ë‚ ì”¨)

```
ğŸ™‹ ì‚¬ìš©ì: ì„œìš¸ì˜ ë‚ ì”¨ê°€ ì–´ë•Œ?
============================================================
ğŸ”§ ë„êµ¬ í˜¸ì¶œ ê°ì§€: ['get_weather']
âœ… ìµœì¢… ì‘ë‹µ ìƒì„± ì™„ë£Œ

ğŸ¤– Agent: í˜„ì¬ ì„œìš¸ì˜ ë‚ ì”¨ëŠ” ë§‘ê³ , ê¸°ì˜¨ì€ 15Â°Cì…ë‹ˆë‹¤.
```

### í…ŒìŠ¤íŠ¸ 2: ë„êµ¬ ì‚¬ìš© (ê³„ì‚°)

```
ğŸ™‹ ì‚¬ìš©ì: 123 * 456ì€ ì–¼ë§ˆì•¼?
============================================================
ğŸ”§ ë„êµ¬ í˜¸ì¶œ ê°ì§€: ['calculate']
âœ… ìµœì¢… ì‘ë‹µ ìƒì„± ì™„ë£Œ

ğŸ¤– Agent: 123 Ã— 456 = 56,088 ì…ë‹ˆë‹¤.
```

### í…ŒìŠ¤íŠ¸ 3: ë„êµ¬ ë¶ˆí•„ìš”

```
ğŸ™‹ ì‚¬ìš©ì: ì•ˆë…•í•˜ì„¸ìš”!
============================================================
âœ… ìµœì¢… ì‘ë‹µ ìƒì„± ì™„ë£Œ

ğŸ¤– Agent: ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?
```

---

## ì—°ìŠµ ë¬¸ì œ

### 1. ìƒˆë¡œìš´ ë„êµ¬ ì¶”ê°€

ê²€ìƒ‰ ë„êµ¬ë¥¼ ì¶”ê°€í•´ë³´ì„¸ìš”:

```python
@tool
def search_web(query: str) -> str:
    """ì›¹ì—ì„œ ì •ë³´ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤."""
    # êµ¬í˜„í•´ë³´ì„¸ìš”
    pass
```

### 2. ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ìˆ˜ì •

ë‹¤ë¥¸ í˜ë¥´ì†Œë‚˜ë¥¼ ê°€ì§„ Agentë¡œ ë³€ê²½í•´ë³´ì„¸ìš”.

### 3. ìŠ¤íŠ¸ë¦¬ë° ì‹¤í–‰

`invoke()` ëŒ€ì‹  `stream()`ì„ ì‚¬ìš©í•´ ì‹¤ì‹œê°„ ì¶œë ¥ì„ í™•ì¸í•˜ì„¸ìš”.

```python
for event in graph.stream(initial_state):
    print(event)
```

---

## ë‹¤ìŒ ë‹¨ê³„

â¡ï¸ [02. Naive RAG](02_naive_rag.md) - ê¸°ë³¸ RAG íŒŒì´í”„ë¼ì¸ êµ¬í˜„
